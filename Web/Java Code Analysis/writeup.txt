Challenge: Java Code Analysis!?!
Author: Nandan Desai
Description
BookShelf Pico, my premium online book-reading service.I believe that my website is super secure. I challenge you to prove me wrong by reading the 'Flag' book!
Additional details will be available after launching your challenge instance.
Findings:
JWT (JSON Web Token):
This is a safe way to send information between client and the server. In JWT the data is secured with a cryptographic signature, the client requests to the server with the encoded payload consisting of 3 parts
1. Header
{
  "alg": "HS256",
  "typ": "JWT"
}
This says:
* What algorithm is used to sign
* That it's a JWT
2. Payload
{
  "role": "USER",
  "userId": 2
}
This is just base64 encoded JSON. It is NOT encrypted.
Anyone can read it.
JWT = readable.
Not secret.
Just signed.


 3. Signature
This is the important part.
The signature is created like this:
HMACSHA256(
   base64(header) + "." + base64(payload),
   secret
)
That means:
If you change the payload,
the signature breaks.
UNLESS…
You know the secret.
In this challenge a source code and a website link was given and a sample login credentials (user: user) was given. In which I could find a flag file but it was restricted, only admin was given access. So I inspected on the local storage I could find that the authentication is handled by JWT. Decoded the JWT, then I started looking at the source code given from which I found main directory I got a java file which named “Secret Generator” from which I got the hint that the key is 1234, changed the JWT to get admin privilege which returned the flag.
 




